cmake_minimum_required(VERSION 3.17)
project(SaintCore LANGUAGES CXX)

# –ò—Å–ø–æ–ª—å–∑—É–µ–º C++17, –∫–∞–∫ —Ç—Ä–µ–±—É–µ—Ç LibTorch
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_POSITION_INDEPENDENT_CODE ON)

# –í–∫–ª—é—á–∞–µ–º –≤–∞—à–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏
include_directories(.)
include_directories(include)
include_directories(include/perfect_visualization)

# üîß –û—Å–Ω–æ–≤–Ω–æ–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª
add_executable(SaintCore
        src/functions.cpp
        src/model.cpp
        src/tensor.cpp
        src/container.cpp
        main_container.cpp
        visualization.cpp
        src/Image.cpp
        src/bmp_writer.cpp
        mnist_reader.cpp
)

# üéØ GoogleTest
include(FetchContent)
FetchContent_Declare(
        googletest
        GIT_REPOSITORY https://github.com/google/googletest.git
        GIT_TAG        v1.14.0
)
FetchContent_MakeAvailable(googletest)

add_executable(SaintCoreTests
        src/functions.cpp
        src/model.cpp
        src/tensor.cpp
        src/container.cpp
        tests/test_functions.cpp
        tests/test_tensor.cpp
        tests/test_model.cpp
        tests/test_arab_conbtainer.cpp
)
target_include_directories(SaintCoreTests PRIVATE ${CMAKE_SOURCE_DIR}/include)
target_link_libraries(SaintCoreTests PRIVATE gtest_main)

enable_testing()
include(GoogleTest)
gtest_discover_tests(SaintCoreTests)
